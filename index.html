<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <title>Apocrypha: Perl 6 documentation in 2019 and beyond</title>
    
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/white.css">
    <link rel="stylesheet" href="css/extra.css">
    
    <!-- Theme used for syntax highlighting of code -->
    <link rel="stylesheet" href="lib/css/monokai.css">
    
    <!-- Printing and PDF exports -->
    <script>
      var link = document.createElement( 'link' );
      link.rel = 'stylesheet';
      link.type = 'text/css';
      link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
      document.getElementsByTagName( 'head' )[0].appendChild( link );
    </script>
  </head>
  <body>
    <div class="reveal">
      <div class="slides">
	<section data-background='https://live.staticflickr.com/65535/48298599411_ac9b4f88f9_k_d.jpg'>
	  <h1>Apocrypha: Stories about Perl 6 documentation</h1>
	  <h2><code>@jjmerelo</code></h2>
	</section>

	<section><h1>Apocrypha</h1>
	  <h2 class='fragment'>Hidden, or</h2>
	  <h2 class='fragment'>of doubtful origin</h2>
	</section>

	<section><h1>Apocalypses, exegeses, synopses</h1>
	</section>

	<section> <!-- specs -->
	  <section>
	    <h1>Synopsis 26: documentation</h1>
	    <h2 class='fragment'>Call me Pod</h2>
	    <aside class='notes'>We call it Pod6 or Perl 6 Pod, mainly to distinguish it from Perl 5's Plain Old Documentation. Not an acronym, also.</aside>
	  </section>

	  <section><h1>Pod6 is <strong>part of the language</strong></h1>
	      <h1 class='fragment'>Document as|is code</h1>
	    <aside class='notes'>This distinguishes Perl 6 (yet again) from other languages, that generally consider comments (and included documentation) off limits, and to be processed externally by some document-generation tool</aside>
	  </section>

	  <section><h1>One of many <strong>braids</strong></h1>

	    <aside class='notes'>A brief writeup <a href='https://mouq.github.io/slangs.html'>here, by Alexander Moquin</a></aside>
	  </section>

	  <section data-background='https://live.staticflickr.com/65535/48431949907_c415a9c8b2_o_d.jpg'>
	    <h1>Perl 6 parses comments.</h1>
	    <h1 class='fragment'>Let's call it POM</h1>
	  </section>
	</section>
	
	<!-- Intro to pod 6 -->
	<section>
	  <section><h1>This is Pod6</h1>
	    <pre><code>=begin pod
This ordinary paragraph introduces a code block:

    $this = 1 * code('block');
    $which.is_specified(:by&lt;indenting>);
=end pod
	    </code></pre>
	  </section>

	  <section><h1>This, too</h1>
	    <pre><code>=head3 X&lt;C&lt;string literal>>
C<'scores.txt'> is a I&t;string literal>.

=begin code :preamble&lt;my $file>
my @names = $file.get.words;
=end code
	    </code></pre>
	    <h2 class='fragment'>Code is also doc</h2>

	    <aside class='notes'>This can cause all kinds of problems, since you can't easily separate code from doc-e.</aside>

	  </section>

	  <section><h1>Docs from code</h1>
<pre><code>=begin pod
This is I&lt;apocrypha>
=head1 Lesson 1
Doc is code
=end pod
say $=pod[0].perl;
=output
Pod::Block::Named.new(name => "pod", config => {}, contents => [Pod::Block::Para.new(config => {}, contents => ["This is ", Pod::FormattingCode.new(type => "I", meta => [], config => {}, contents => ["apocrypha"])]), Pod::Heading.new(level => 1, config => {}, contents => [Pod::Block::Para.new(config => {}, contents => ["Lesson 1"])]), Pod::Block::Para.new(config => {}, contents => ["Doc is code"])])
</code></pre>
	  </section>
	  
	</section>

	<section>
	  <section><h1>In the beginning, there was code</h1>
	    <aside class='notes'>Why is Perl 6 not documented by the same people who write the Rakudo compiler</aside>
	  </section>

	  <section><h2>S26 implemented...</h2>
	    <h1 class='fragment'><strong>January 2012</strong> by <code>tadzik</code></h1>
	    <h2 class='fragment'>Mainly in NQP</h2>
	  </section>

	  <section><h1>A few months later...</h1>
	    <img src='img/commits.png' alt='Initial commits'>
	  </section>

	  <section><h3>FAQ: Why don't doc inline in Rakudo?</h3>
	    <h1 class='fragment'>It's <strong>too slow</strong></h1>
	    <aside class='notes'>Since docs are code, that code will also take some (or a lot) of time to compile, slowing down the whole operation</aside>
	  </section>

	  <section data-background='https://live.staticflickr.com/4304/35578237540_5bc53058f4_k_d.jpg'>
	    <h1>Thus start apocrypha</h1>
	    <h2 class='fragment'>Hidden book, separated from code</h2>
	  </section>

	  <section data-background='https://live.staticflickr.com/1788/27993240507_03d9629b11_k_d.jpg'>
	    <h1><code>perl6/doc</code> evolved organically</h1>
	    <h2 class='fragment'>Along with Pod6 implementation</h2>
	    <aside class='notes'>S26 is far from finished. There's still a long way to go, but the main things are the includes with P, the implementation of the indexing engine.</aside>
	  </section>
	</section>
	
	<section> <!-- what we have now -->
	  <section data-background='img/document-structure.png'>
	  </section>

	  <section data-background='img/type-def.png'>
	  </section>

	  <section><h1>Pod6</h1>
	    <h1 class='fragment'>⇒Index/fragment</h1>
	    <h1 class='fragment'>⇒⇒Aggregate + Typegraph + highlight</h1>
	    <h1 class='fragment'>⇒⇒⇒Static HTML</h1>
	  </section>
	  
	  <section data-background='img/cover.png'>
	    <h1>Our target</h1>
	    
	  </section>

	  <section><h1>In the repo</h1>
	    <h2 class='fragment'>Documentation</h2>
	    <h2 class='fragment'>Tests</h2>
	    <h2 class='fragment'>Tooling for Pod6 → Static site</h2>
	    <h2 class='fragment'><code>p6doc</code></h2>
	    <aside class='notes'>It's a hodgepodge of things with many authors, which is becoming unwieldy</aside>
	  </section>

	  <section data-background='https://live.staticflickr.com/7893/33370507668_ee504da0c5_k_d.jpg'><h1>Sloooow</h1>
	    <h2 class='fragment'>Tooling specific, undocumented and untested</h2>
	  </section>

	  <section data-background='img/htmlify.png'><h1>Exhibit A</h1>
	  </section>

	  <section><h1>Also</h1>
	    <h2 class='fragment'>Mojolicious for server</h2>
	    <h2 class='fragment'>No roadmap</h2>
	    <h2 class='fragment'>No release policy</h2>
	  </section>

	  <section><img src='img/doc-survey-18.png'  style='height:300px' alt='Survey 2018'>
	    <img class='fragment' src='img/doc-survey-19.png' style='height:300px' alt='Survey 2019'>
	    <aside class='notes'>Largely due to improvement in content, addressing issues, and so on</aside></section>

	  <section><img src='img/score.png' alt='score boxplot' style='height:700px'>
	    <aside class='notes'>Still, score has gone from 6.9 to 7.3, 4 decimal points. From B- to B+, but it's still B. Basically, there's less people who think it sucks, but there's pretty much as many people that think it needs improvement.</aside>
	  </section>
	  
	  <section data-background='https://live.staticflickr.com/1481/24508569703_c2ac1ba035_k_d.jpg'>
	    <h1>Drift from source</h1>
	    <h1 class='fragment'>No specs for site</h1>
	  </section>
	</section>


	<section>
	  <section data-background='https://live.staticflickr.com/65535/48385502322_45645bbbc0_k_d.jpg'><h1>The present</h1>
	  </section>
	  <section data-background='https://live.staticflickr.com/65535/48424584911_865eb528a4_k_d.jpg'>
	    <h1>Google Summer of Code</h1>
	    <h2 class='fragment'>Antonio → <code>documentable</code></h2>
	    <h2 class='fragment'>Joel → <code>p6doc++</code></h2>
	  </section>

	  <section><h2>Richard Hainsworth's Pod::To::Cached</h2>
	    <pre><code>my Pod::To::Cached $cache .= new(:source&lt;../pods>);
$cache.update-cache;
for $cache.hash-files.kv -> $source-name, $status {
    say "$source-name is $status";
    say $cache.pod($source-name);
}
	    </code></pre>
	    <h2 class='fragment'>Compile only once</h2>
	    <aside class='notes'>Effectively precompiles and caches documents. This is actually previous to GSoC, but it's been during GSoC when we have it production ready. Also example of cached, thus hidden, thus apocrypha! </aside>
	  </section>
	</section>


      </div>
    </div>

    <script src="js/reveal.js"></script>
    
    <script>
      // More info about config & dependencies:
      // - https://github.com/hakimel/reveal.js#configuration
      // - https://github.com/hakimel/reveal.js#dependencies
      Reveal.initialize({
      width: '95%',
      controls: true,
      progress: true,
      history: true,
      dependencies: [
      { src: 'plugin/markdown/marked.js' },
      { src: 'plugin/markdown/markdown.js' },
      { src: 'plugin/notes/notes.js', async: true },
      { src: 'plugin/highlight/highlight.js', async: true }
      ]
      });
    </script>
  </body>
</html>
